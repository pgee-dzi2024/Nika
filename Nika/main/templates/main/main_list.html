{% extends 'main/base.html' %}
{% load static %}

{% block left_panel %}
{% include 'main/left_panel_list.html' %}
{% endblock %}

{% block lef_panel_icon%}
                                <div class="expand-btn-grp @@display-class" xmlns="http://www.w3.org/1999/html">
                                    <button class="bg-solid-primary popup-dashboardright-btn">
                                        <i class="feather-sidebar right"></i>
                                    </button>
                                </div>
{% endblock %}

{% block main_content %}
            <!-- Main content -->
            <div class="rbt-main-content">
                <div class="rbt-daynamic-page-content">
                    <!-- Start Breadcarumb area  -->
                    <div class="chatenai-separator">
                        <img class="w-100 separator-dark"
                             src="{% static 'assets/images/separator/separator-top.svg' %}" alt="separator">
                        <img class="w-100 separator-light"
                             src="{% static 'assets/images/light/separator/separator-top.svg' %}" alt="separator">
                    </div>
                    <div class="breadcrumb-area breadcarumb-style1 pt--30 pb--30">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="breadcrumb-inner text-center">
                                        <h1 v-if="sysParams.showMode==0" class="title theme-gradient h2">Регистрация</h1>
                                        <h1 v-if="sysParams.showMode==1" class="title theme-gradient h2">Старт</h1>
                                        <h1 v-if="sysParams.showMode==2" class="title theme-gradient h2">Състезание</h1>
                                        <h1 v-if="sysParams.showMode==3" class="title theme-gradient h2">Класиране</h1>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End Breadcarumb area  -->
                    <div class="chatenai-separator">
                        <img class="w-100 separator-dark" src="{% static 'assets/images/separator/separator-bottom.svg' %}" alt="separator">
                        <img class="w-100 separator-light" src="{% static 'assets/images/light/separator/separator-bottom.svg' %}" alt="separator">
                    </div>

                    <!-- Dashboard Center Content -->
                    <div class="rbt-dashboard-content">
                        <div class="content-page">
                            <!-- --------------------- -->
                            <!--      Регистрация      -->
                            <!-- --------------------- -->
                            <div class="chat-box-list pt--30">
                                <!-- списък на участниците -->
                                <div v-for="(user_obj, user_idx) in listOfUsers">
                                    <div class="chat-box ai-speech bg-flashlight mt--10" style="padding: 10px;"
                                         v-if="((user_obj.userprofile.access_level == 3)&&
                                                (user_obj.userprofile.school==user.school))"
                                         :id="'usr'+user_idx">
                                        <!-- показвам всички въпроси от тема/точка/ниво (theme/item/level) qst -->
                                        <div class="inner top-flashlight leftside light-xl">
                                            <!-- Заглавна част - параметри на въпроса -->
                                            <div class="chat-section generate-section">
                                                <div class="chat-content">
                                                    <div class="row">
                                                        <div class="col-lg-6 col-md-6 col-sm-6 col-12">
                                                            <h6 class="title">
                                                                [[ user_obj.first_name ]]  [[ user_obj.last_name ]] ([[ user_obj.username ]])
                                                            </h6>
                                                        </div>
                                                        <!-- copy -->
                                                        <div class="col-lg-6 col-md-6 col-sm-6 col-12 d-flex justify-content-end">
                                                            <button class="react-btn btn-default btn-small btn-border"
                                                                    style="font-size: 12px; color: red; border-color: #5c0000d4;"
                                                                    @click="editUser(user_idx)"
                                                                    data-bs-toggle="modal" data-bs-target="#deleteUserModal">
                                                                <i class="feather-user-x"></i><span>&nbsp;Премахни&nbsp;</span>
                                                            </button>
                                                            &nbsp;&nbsp;
                                                            <button class="react-btn btn-default btn-small btn-border"
                                                                    @click="editUser(user_idx)"
                                                                    data-bs-toggle="modal" data-bs-target="#setUserPasswordModal"
                                                                    style="font-size: 12px; color: #0600ff; border-color: rgb(10 88 202 / 29%);">
                                                                <i class="feather-user-check"></i><span>&nbsp;Парола&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                            </button>
                                                            &nbsp;&nbsp;
                                                            <button class="react-btn btn-default btn-small btn-border"
                                                                    @click="editUser(user_idx)"
                                                                    data-bs-toggle="modal" data-bs-target="#editUserModal"
                                                                    style="font-size: 12px; color: green; border-color: #013401;">
                                                                <i class="feather-edit"></i><span>&nbsp;Данни&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                            </button>
                                                        </div>
                                                    </div>
                                               </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="rbt-static-bar collapse-width">
                            <!-- Долна лента с бутони  -->
                            <!-- --------------------- -->
                            <!--      Регистрация      -->
                            <!-- --------------------- -->
                            <ul  v-if="sysParams.showMode==0" class="staticbar-btn-grp d-md-flex">
                                <li>
                                    <button class="react-btn btn-default btn-small btn-border"
                                            style="color: green; border-color: #013401;"
                                            data-bs-toggle="modal" data-bs-target="#editAthleteModal">
                                        <i class="feather-check"></i><span>&nbspДобави нов участник</span>
                                    </button>
                                </li>
                                <li>
                                    <button class="react-btn btn-default btn-small btn-border"
                                            style="color: red; border-color: #5c0000d4;" @click="closeRegistration()">
                                        <i class="feather-x"></i><span>&nbspКрай на регистрацията</span>
                                    </button>
                                </li>
                            </ul>
                            <!-- Превключвател свтла/тъмнa тема  -->
                            <div id="my_switcher" class="my_switcher">
                                <ul>
                                    <li>
                                        <a href="javascript: void(0);" data-theme="light" class="setColor light">
                                            <img src="{% static 'assets/images/light/switch/sun-01.svg' %}" alt="Sun images"><span title="Light Mode"> Light</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript: void(0);" data-theme="dark" class="setColor dark">
                                            <img src="{% static 'assets/images/light/switch/vector.svg' %}" alt="Vector Images"><span title="Dark Mode">
                                        Dark</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Dashboard Right Content -->
                    <!-- --------------------- -->
                    <!--      Регистрация      -->
                    <!-- --------------------- -->
                    <div  v-if="sysParams.showMode==0" class="rbt-right-side-panel popup-dashboardright-section">

                        <div class="right-side-top">
                            <h6 class="title">Регистрирани участници:</h6>
                            <p>общо [[ athletes.length ]]</p>
                        </div>
                        <div class="right-side-bottom mb--200">
                            <div class="chat-history-section"
                                 v-for="(theme_item, idx) in theme">
                                <h6 class="title">[[theme_item.item]]. [[theme_item.title]]</h6>
                                <ul class="chat-history-list">
                                    <li class="history-box active">
                                        <div class="dropdown history-box-dropdown">
                                            <button type="button" class="more-info-icon dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="feather-more-horizontal"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item"
                                                       @click="make_new_q(theme_item.id, 1)"
                                                       data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                    <i class="feather-file-plus"></i> Добави</a>
                                                </li>
                                                <li><a class="dropdown-item" :href="'#T'+idx+'L1'"><i class="feather-corner-up-left"></i> Покажи</a></li>
                                            </ul>
                                        </div>
                                        Знание
                                        <span :class="{'bg-color-good': verifyQuestionQty(1, idx, 3),
                                                       'bg-color-mid': verifyQuestionQty(1, idx, 2),
                                                       'bg-color-bad': verifyQuestionQty(1, idx, 1),
                                                      }">
                                            &nbsp;[[theme_item.q_knowledge]] (мин.[[theme_item.knowledge]])&nbsp; </span>
                                    </li>
                                    <li class="history-box active">
                                        <div class="dropdown history-box-dropdown">
                                            <button type="button" class="more-info-icon dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="feather-more-horizontal"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item"
                                                       @click="make_new_q(theme_item.id, 2)"
                                                       data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                    <i class="feather-file-plus"></i> Добави</a>
                                                </li>
                                                <li><a class="dropdown-item" :href="'#T'+idx+'L2'"><i class="feather-corner-up-left"></i> Покажи</a></li>
                                            </ul>
                                        </div>
                                        Разбиране
                                        <span  :class="{'bg-color-good': verifyQuestionQty(2, idx, 3),
                                                       'bg-color-mid': verifyQuestionQty(2, idx, 2),
                                                       'bg-color-bad': verifyQuestionQty(2, idx, 1),
                                                       }">
                                            &nbsp;[[theme_item.q_comprehension]] (мин.[[theme_item.comprehension]])&nbsp; </span>
                                    </li>
                                    <li class="history-box active">
                                        <div class="dropdown history-box-dropdown">
                                            <button type="button" class="more-info-icon dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="feather-more-horizontal"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item"
                                                       @click="make_new_q(theme_item.id, 3)"
                                                       data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                    <i class="feather-file-plus"></i> Добави</a>
                                                </li>
                                                <li><a class="dropdown-item" :href="'#T'+idx+'L3'"><i class="feather-corner-up-left"></i> Покажи</a></li>
                                            </ul>
                                        </div>
                                        Приложение
                                        <span :class="{'bg-color-good': verifyQuestionQty(3, idx, 3),
                                                       'bg-color-mid': verifyQuestionQty(3, idx, 2),
                                                       'bg-color-bad': verifyQuestionQty(3, idx, 1),
                                                       }">
                                            &nbsp;[[theme_item.q_application]] (мин.[[theme_item.application]])&nbsp; </span>
                                    </li>
                                    <li class="history-box active">
                                        <div class="dropdown history-box-dropdown">
                                            <button type="button" class="more-info-icon dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="feather-more-horizontal"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item"
                                                       @click="make_new_q(theme_item.id, 4)"
                                                       data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                    <i class="feather-file-plus"></i> Добави</a>
                                                </li>
                                                <li><a class="dropdown-item" :href="'#T'+idx+'L4'"><i class="feather-corner-up-left"></i> Покажи</a></li>
                                            </ul>
                                        </div>
                                        Анализ
                                        <span  :class="{'bg-color-good': verifyQuestionQty(4, idx, 3),
                                                       'bg-color-mid': verifyQuestionQty(4, idx, 2),
                                                       'bg-color-bad': verifyQuestionQty(4, idx, 1),
                                                       }">
                                            &nbsp;[[theme_item.q_analysis]] (мин.[[theme_item.analysis]])&nbsp; </span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
{% endblock %}

{% block modals %}
        <!-- Данни за състезател -->
        <div id="editAthleteModal" class="modal rbt-modal-box like-modal fade" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content wrapper top-flashlight leftside light-xl">
                    <h5 class="title">
                        Нов участник</h5>
                    <!-- бутон горе ляво - затваряне на прозореца -->
                    <button class="close-button" data-bs-dismiss="modal">
                       <i class="feather-x"></i>
                   </button>
                    <!-- footer - бутони за отказ/запис -->
                    <div class="row mt--20">
                       <div class="col-lg-2 col-md-2">
                       </div>
                        <div class="col-lg-10 col-md-10 col-sm-10 col-12" style="text-align: right;">
                            <div class="btn-grp">
                                <button class="react-btn btn-default btn-small btn-border bg-color-danger"
                                       data-bs-dismiss="modal">
                                   <i class="feather-x"></i><span>&nbsp;Откажи</span>
                                </button>
                                &nbsp
                                <button class="react-btn btn-default btn-small btn-border bg-color-success"
                                       data-bs-dismiss="modal" @click="saveUserLogic()">
                                   <i class="feather-check"></i><span>&nbsp;Запази</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
       </div>
{% endblock %}

{% block page_script %}
    <script src="{% static 'assets/js/race.js' %}"></script>
{% endblock %}
